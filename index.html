<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤</title>
    <link rel="stylesheet" href="css_styles.css">
</head>
<body>
    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="logo">
                üí∞ –§–∏–Ω–∞–Ω—Å—ã
            </div>
            
            <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
            <div class="auth-section">
                <div class="user-info" id="userInfo">
                    <button class="auth-btn" onclick="signInWithGoogle()">
                        üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
                    </button>
                </div>
                <div class="sync-indicator sync-offline" id="syncIndicator">
                    ‚ö†Ô∏è –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
                </div>
            </div>
            
            <nav>
                <div class="nav-item active" onclick="showPage('dashboard')">
                    <span class="nav-icon">üìä</span>
                    <span>–î–∞—à–±–æ—Ä–¥</span>
                </div>
                <div class="nav-item" onclick="showPage('transactions')">
                    <span class="nav-icon">üí≥</span>
                    <span>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</span>
                </div>
                <div class="nav-item" onclick="showPage('exchange')">
                    <span class="nav-icon">üí±</span>
                    <span>–û–±–º–µ–Ω –≤–∞–ª—é—Ç</span>
                </div>
                <div class="nav-item" onclick="showPage('categories')">
                    <span class="nav-icon">üìÇ</span>
                    <span>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
                </div>
                <div class="nav-item" onclick="showPage('analytics')">
                    <span class="nav-icon">üìà</span>
                    <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                </div>
            </nav>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="header">
                <div class="header-left">
                    <h1 class="header-title" id="page-title">–î–∞—à–±–æ—Ä–¥</h1>
                    <div class="month-selector">
                        <select id="monthSelect" onchange="onMonthChange()">
                            <option value="0">–Ø–Ω–≤–∞—Ä—å 2025</option>
                            <option value="1">–§–µ–≤—Ä–∞–ª—å 2025</option>
                            <option value="2">–ú–∞—Ä—Ç 2025</option>
                            <option value="3">–ê–ø—Ä–µ–ª—å 2025</option>
                            <option value="4">–ú–∞–π 2025</option>
                            <option value="5">–ò—é–Ω—å 2025</option>
                            <option value="6">–ò—é–ª—å 2025</option>
                            <option value="7">–ê–≤–≥—É—Å—Ç 2025</option>
                            <option value="8">–°–µ–Ω—Ç—è–±—Ä—å 2025</option>
                            <option value="9">–û–∫—Ç—è–±—Ä—å 2025</option>
                            <option value="10">–ù–æ—è–±—Ä—å 2025</option>
                            <option value="11">–î–µ–∫–∞–±—Ä—å 2025</option>
                        </select>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="exportToExcel()">
                        üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="btn btn-primary" onclick="openAddTransactionModal()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                    </button>
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="content">
                <!-- –î–∞—à–±–æ—Ä–¥ -->
                <div id="dashboard" class="page active">
                    <div class="dashboard-grid">
                        <div class="balance-card">
                            <div class="balance-amount" id="total-balance">0 MDL</div>
                            <div class="balance-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
                        </div>
                        
                        <div class="quick-actions">
                            <div class="quick-action income" onclick="openAddTransactionModal('income')">
                                <div class="quick-action-icon">üí∞</div>
                                <div>–î–æ—Ö–æ–¥</div>
                            </div>
                            <div class="quick-action expense" onclick="openAddTransactionModal('expense')">
                                <div class="quick-action-icon">üí∏</div>
                                <div>–†–∞—Å—Ö–æ–¥</div>
                            </div>
                            <div class="quick-action exchange" onclick="showPage('exchange')">
                                <div class="quick-action-icon">üí±</div>
                                <div>–û–±–º–µ–Ω</div>
                            </div>
                        </div>
                    </div>

                    <!-- –°–≤–æ–¥–∫–∞ –ø–æ –≤–∞–ª—é—Ç–∞–º -->
                    <div class="summary" id="summaryContainer"></div>

                    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
                    <div class="transactions-table">
                        <div class="table-header">
                            <h3 class="table-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
                            <button class="btn btn-primary" onclick="showPage('transactions')">–í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</button>
                        </div>
                        <div id="recent-transactions"></div>
                    </div>
                </div>

                <!-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
                <div id="transactions" class="page">
                    <div class="transactions-table">
                        <div class="table-header">
                            <h3 class="table-title">–í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
                            <div style="display: flex; gap: 12px;">
                                <select class="form-select" style="width: auto;" onchange="filterTransactions()" id="typeFilter">
                                    <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                                    <option value="income">–î–æ—Ö–æ–¥—ã</option>
                                    <option value="expense">–†–∞—Å—Ö–æ–¥—ã</option>
                                </select>
                                <button class="btn btn-primary" onclick="openAddTransactionModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–¢–∏–ø</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–í–∞–ª—é—Ç–∞</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                                    </tr>
                                </thead>
                                <tbody id="transactionTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –û–±–º–µ–Ω –≤–∞–ª—é—Ç -->
                <div id="exchange" class="page">
                    <div class="exchange-section">
                        <div class="exchange-header">
                            <button class="back-btn" onclick="showPage('dashboard')">
                                <span class="back-arrow">‚Üê</span> –ù–∞–∑–∞–¥
                            </button>
                            <h3>üí± –û–±–º–µ–Ω –≤–∞–ª—é—Ç</h3>
                        </div>
                        <div class="exchange-form">
                            <!-- –û—Ç–¥–∞–µ—Ç–µ -->
                            <div class="exchange-card from-card">
                                <label class="exchange-label">–û—Ç–¥–∞–µ—Ç–µ</label>
                                <div class="currency-input-group">
                                    <input type="number" id="fromAmountInput" placeholder="0.00" step="0.01" oninput="calculateExchangeRate()" class="amount-input">
                                    <select id="fromCurrencySelect" onchange="calculateExchangeRate()" class="currency-select">
                                        <option value="MDL">MDL</option>
                                        <option value="UAH">UAH</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                        <option value="USDT">USDT</option>
                                    </select>
                                </div>
                            </div>

                            <!-- –°—Ç—Ä–µ–ª–∫–∞ –æ–±–º–µ–Ω–∞ -->
                            <div class="exchange-arrow-container">
                                <button class="swap-btn" onclick="swapCurrencies()" title="–ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ –≤–∞–ª—é—Ç—ã">
                                    <span class="swap-icon">‚áÖ</span>
                                </button>
                            </div>

                            <!-- –ü–æ–ª—É—á–∞–µ—Ç–µ -->
                            <div class="exchange-card to-card">
                                <label class="exchange-label">–ü–æ–ª—É—á–∞–µ—Ç–µ</label>
                                <div class="currency-input-group">
                                    <input type="number" id="toAmountInput" placeholder="0.00" step="0.01" oninput="calculateExchangeRate()" class="amount-input">
                                    <select id="toCurrencySelect" onchange="calculateExchangeRate()" class="currency-select">
                                        <option value="UAH" selected>UAH</option>
                                        <option value="MDL">MDL</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                        <option value="USDT">USDT</option>
                                    </select>
                                </div>
                            </div>

                            <!-- –ö—É—Ä—Å –æ–±–º–µ–Ω–∞ -->
                            <div class="rate-display" id="rateDisplay">
                                –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∫—É—Ä—Å–∞
                            </div>

                            <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–º–µ–Ω–∞ -->
                            <button class="btn btn-primary exchange-btn" onclick="addExchange()">
                                <span class="btn-icon">üí±</span>
                                –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–º–µ–Ω
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div id="categories" class="page">
                    <div id="categoryBreakdown" class="categories-grid"></div>
                </div>

                <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <div id="analytics" class="page">
                    <h2>–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h2>
                    <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –≥—Ä–∞—Ñ–∏–∫–∏, –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="transaction-form" onsubmit="addTransaction(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞</label>
                        <input type="date" class="form-input" id="dateInput" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø</label>
                        <select class="form-select" id="typeSelect" onchange="updateCategoryOptions()">
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-select" id="categorySelect" required></select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞</label>
                        <input type="number" class="form-input" id="amountInput" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–í–∞–ª—é—Ç–∞</label>
                        <select class="form-select" id="currencySelect">
                            <option value="MDL">MDL</option>
                            <option value="UAH">UAH</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="USDT">USDT</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="descriptionInput" placeholder="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ">
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—à–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="js_firebase.js"></script>
    <script src="js_app.js"></script>
    <script src="js_ui.js"></script>
</body>
</html>