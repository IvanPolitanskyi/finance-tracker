<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>–£—á–µ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤</title>
    <link rel="stylesheet" href="css_styles.css">
</head>
<body>
    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="logo">
                üí∞ –§–∏–Ω–∞–Ω—Å—ã
            </div>
            
            <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
            <div class="auth-section">
                <div class="user-info" id="userInfo">
                    <button class="auth-btn" onclick="signInWithGoogle()">
                        üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
                    </button>
                </div>
                <div class="sync-indicator sync-offline" id="syncIndicator">
                    ‚ö†Ô∏è –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
                </div>
            </div>
            
            <nav>
                <div class="nav-item active" onclick="showPage('dashboard')">
                    <span class="nav-icon">üìä</span>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </div>
                <div class="nav-item" onclick="showPage('transactions')">
                    <span class="nav-icon">üìú</span>
                    <span>–ò—Å—Ç–æ—Ä–∏—è</span>
                </div>
                <div class="nav-item" onclick="showPage('exchange')">
                    <span class="nav-icon">üí±</span>
                    <span>–û–±–º–µ–Ω</span>
                </div>
                <div class="nav-item" onclick="showPage('categories')">
                    <span class="nav-icon">üìà</span>
                    <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                </div>
            </nav>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="header">
                <div class="header-left">
                    <h1 class="header-title" id="page-title">–î–∞—à–±–æ—Ä–¥</h1>
                    <div class="month-selector">
                        <select id="monthSelect" onchange="onMonthChange()">
                            <option value="0">–Ø–Ω–≤–∞—Ä—å 2025</option>
                            <option value="1">–§–µ–≤—Ä–∞–ª—å 2025</option>
                            <option value="2">–ú–∞—Ä—Ç 2025</option>
                            <option value="3">–ê–ø—Ä–µ–ª—å 2025</option>
                            <option value="4">–ú–∞–π 2025</option>
                            <option value="5">–ò—é–Ω—å 2025</option>
                            <option value="6">–ò—é–ª—å 2025</option>
                            <option value="7">–ê–≤–≥—É—Å—Ç 2025</option>
                            <option value="8">–°–µ–Ω—Ç—è–±—Ä—å 2025</option>
                            <option value="9">–û–∫—Ç—è–±—Ä—å 2025</option>
                            <option value="10">–ù–æ—è–±—Ä—å 2025</option>
                            <option value="11">–î–µ–∫–∞–±—Ä—å 2025</option>
                        </select>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="exportToExcel()">
                        üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="btn btn-primary" onclick="openAddTransactionModal()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                    </button>
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="content">
                <!-- –î–∞—à–±–æ—Ä–¥ -->
                <div id="dashboard" class="page active">
                    <!-- –ë–∞–ª–∞–Ω—Å—ã –ø–æ –≤–∞–ª—é—Ç–∞–º -->
                    <div class="currency-balances" id="currencyBalances">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è -->
                    </div>

                    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                    <div class="quick-action-buttons">
                        <button class="quick-btn income-btn" onclick="showQuickAddTransaction('income')">
                            <span class="quick-btn-icon">üí∞</span>
                            <span class="quick-btn-text">–î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</span>
                        </button>
                        <button class="quick-btn expense-btn" onclick="showQuickAddTransaction('expense')">
                            <span class="quick-btn-icon">üí∏</span>
                            <span class="quick-btn-text">–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</span>
                        </button>
                    </div>

                    <!-- –ë—ã—Å—Ç—Ä–∞—è —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div class="quick-add-form" id="quickAddForm" style="display: none;">
                        <div class="quick-add-header">
                            <h3 id="quickAddTitle">–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h3>
                            <button class="close-quick-form" onclick="hideQuickAddTransaction()">‚úï</button>
                        </div>

                        <div class="amount-section">
                            <input type="number" id="quickAmountInput" placeholder="0" class="quick-amount-input" step="0.01">
                            <div class="quick-amounts">
                                <button class="quick-amount-btn" onclick="setQuickAmount(50)">50</button>
                                <button class="quick-amount-btn" onclick="setQuickAmount(100)">100</button>
                                <button class="quick-amount-btn" onclick="setQuickAmount(500)">500</button>
                                <button class="quick-amount-btn" onclick="setQuickAmount(1000)">1000</button>
                            </div>
                        </div>

                        <div class="quick-form-row">
                            <select id="quickCurrencySelect" class="quick-select">
                                <option value="MDL">MDL</option>
                                <option value="UAH">UAH</option>
                                <option value="USD">USD</option>
                                <option value="EUR">EUR</option>
                                <option value="USDT">USDT</option>
                            </select>
                            <select id="quickCategorySelect" class="quick-select">
                                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                            </select>
                        </div>

                        <input type="text" id="quickDescriptionInput" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" class="quick-input">

                        <div class="quick-form-actions">
                            <button class="btn btn-secondary" onclick="hideQuickAddTransaction()">–û—Ç–º–µ–Ω–∞</button>
                            <button class="btn btn-primary" onclick="addQuickTransaction()">–î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>

                    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
                    <div class="recent-section">
                        <div class="section-header">
                            <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                            <a href="#" onclick="showPage('transactions'); return false;" class="see-all-link">–í—Å–µ ‚Üí</a>
                        </div>
                        <div id="recentTransactionCards" class="transaction-cards">
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è -->
                        </div>
                    </div>
                </div>

                <!-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
                <div id="transactions" class="page">
                    <!-- –§–∏–ª—å—Ç—Ä—ã -->
                    <div class="transaction-filters">
                        <div class="filter-pills">
                            <button class="filter-pill active" data-filter="all" onclick="filterTransactionsByType('all')">–í—Å–µ</button>
                            <button class="filter-pill" data-filter="income" onclick="filterTransactionsByType('income')">–î–æ—Ö–æ–¥—ã</button>
                            <button class="filter-pill" data-filter="expense" onclick="filterTransactionsByType('expense')">–†–∞—Å—Ö–æ–¥—ã</button>
                            <button class="filter-pill" data-filter="exchange" onclick="filterTransactionsByType('exchange')">–û–±–º–µ–Ω—ã</button>
                        </div>
                    </div>

                    <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –¥–Ω—è–º -->
                    <div id="transactionsList" class="transactions-list">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–Ω—è–º -->
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ" -->
                    <div class="load-more-container" id="loadMoreContainer" style="display: none;">
                        <button class="btn btn-secondary" onclick="loadMoreTransactions()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ</button>
                    </div>
                </div>

                <!-- –û–±–º–µ–Ω –≤–∞–ª—é—Ç -->
                <div id="exchange" class="page">
                    <div class="exchange-section">
                        <div class="exchange-header">
                            <button class="back-btn" onclick="showPage('dashboard')">
                                <span class="back-arrow">‚Üê</span> –ù–∞–∑–∞–¥
                            </button>
                            <h3>üí± –û–±–º–µ–Ω –≤–∞–ª—é—Ç</h3>
                        </div>
                        <div class="exchange-form">
                            <!-- –û—Ç–¥–∞–µ—Ç–µ -->
                            <div class="exchange-row">
                                <label class="exchange-row-label">–û—Ç–¥–∞–µ—Ç–µ</label>
                                <div class="exchange-inputs">
                                    <input type="number" id="fromAmountInput" placeholder="0" step="0.01" oninput="calculateExchangeRate()" class="exchange-amount">
                                    <select id="fromCurrencySelect" onchange="calculateExchangeRate()" class="exchange-currency">
                                        <option value="MDL">MDL</option>
                                        <option value="UAH">UAH</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                        <option value="USDT">USDT</option>
                                    </select>
                                </div>
                            </div>

                            <!-- –°—Ç—Ä–µ–ª–∫–∞ –æ–±–º–µ–Ω–∞ -->
                            <div class="exchange-divider">
                                <button class="swap-currencies" onclick="swapCurrencies()" title="–ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏">
                                    ‚áÖ
                                </button>
                            </div>

                            <!-- –ü–æ–ª—É—á–∞–µ—Ç–µ -->
                            <div class="exchange-row">
                                <label class="exchange-row-label">–ü–æ–ª—É—á–∞–µ—Ç–µ</label>
                                <div class="exchange-inputs">
                                    <input type="number" id="toAmountInput" placeholder="0" step="0.01" oninput="calculateExchangeRate()" class="exchange-amount">
                                    <select id="toCurrencySelect" onchange="calculateExchangeRate()" class="exchange-currency">
                                        <option value="UAH" selected>UAH</option>
                                        <option value="MDL">MDL</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                        <option value="USDT">USDT</option>
                                    </select>
                                </div>
                            </div>

                            <!-- –ö—É—Ä—Å –æ–±–º–µ–Ω–∞ -->
                            <div class="exchange-rate-info" id="rateDisplay">
                                –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—ã
                            </div>

                            <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–º–µ–Ω–∞ -->
                            <button class="exchange-submit-btn" onclick="addExchange()">
                                –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–º–µ–Ω
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <div id="categories" class="page">
                    <!-- –°–≤–æ–¥–∫–∞ –∑–∞ –º–µ—Å—è—Ü -->
                    <div class="month-summary">
                        <div class="summary-card income-summary">
                            <div class="summary-label">–î–æ—Ö–æ–¥—ã –∑–∞ –º–µ—Å—è—Ü</div>
                            <div class="summary-amount" id="monthIncome">0 MDL</div>
                        </div>
                        <div class="summary-card expense-summary">
                            <div class="summary-label">–†–∞—Å—Ö–æ–¥—ã –∑–∞ –º–µ—Å—è—Ü</div>
                            <div class="summary-amount" id="monthExpense">0 MDL</div>
                        </div>
                    </div>

                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                    <div class="categories-section">
                        <h3 class="section-title">–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                        <div id="expenseCategoriesChart" class="categories-chart">
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è -->
                        </div>
                    </div>

                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ -->
                    <div class="categories-section">
                        <h3 class="section-title">–î–æ—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                        <div id="incomeCategoriesChart" class="categories-chart">
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="transaction-form" onsubmit="addTransaction(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞</label>
                        <input type="date" class="form-input" id="dateInput" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø</label>
                        <select class="form-select" id="typeSelect" onchange="updateCategoryOptions()">
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-select" id="categorySelect" required></select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞</label>
                        <input type="number" class="form-input" id="amountInput" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–í–∞–ª—é—Ç–∞</label>
                        <select class="form-select" id="currencySelect">
                            <option value="MDL">MDL</option>
                            <option value="UAH">UAH</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="USDT">USDT</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="descriptionInput" placeholder="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ">
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="mobile-nav">
        <div class="mobile-nav-item active" onclick="showPage('dashboard')" data-page="dashboard">
            <span class="mobile-nav-icon">üìä</span>
            <span class="mobile-nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
        </div>
        <div class="mobile-nav-item" onclick="showPage('transactions')" data-page="transactions">
            <span class="mobile-nav-icon">üìú</span>
            <span class="mobile-nav-label">–ò—Å—Ç–æ—Ä–∏—è</span>
        </div>
        <div class="mobile-nav-item" onclick="showPage('exchange')" data-page="exchange">
            <span class="mobile-nav-icon">üí±</span>
            <span class="mobile-nav-label">–û–±–º–µ–Ω</span>
        </div>
        <div class="mobile-nav-item" onclick="showPage('categories')" data-page="categories">
            <span class="mobile-nav-icon">üìà</span>
            <span class="mobile-nav-label">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—à–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="js_firebase.js"></script>
    <script src="js_app.js"></script>
    <script src="js_ui.js"></script>
</body>
</html>